Derived from Socks4Proxy. 